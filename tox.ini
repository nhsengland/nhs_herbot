[tox]
envlist = py39, py310, py311, py312, lint
isolated_build = true
skip_missing_interpreters = true
requires = tox-uv

[testenv]
description = Run unit tests with pytest
deps =
    pytest
    pytest-cov
    pytest-mock
    pytest-xdist
extras =
    sql
    test
commands = pytest tests/unittests/ -v --cov=nhs_herbot --cov-report=term-missing

[testenv:lint]
description = Run linting and formatting checks with ruff
deps =
    ruff
commands =
    ruff check nhs_herbot/ tests/
    ruff format --check nhs_herbot/ tests/

[testenv:format]
description = Format code with ruff
deps =
    ruff
commands =
    ruff check --fix nhs_herbot/ tests/
    ruff format nhs_herbot/ tests/

[testenv:py39]
basepython = python3.9

[testenv:py310]
basepython = python3.10

[testenv:py311]
basepython = python3.11

[testenv:py312]
basepython = python3.12

[testenv:docs]
description = Build documentation
deps =
    mkdocs
    mkdocs-material
changedir = docs
commands = mkdocs build

[testenv:docs-serve]
description = Serve documentation locally
deps =
    mkdocs
    mkdocs-material
changedir = docs
commands = mkdocs serve

[gh-actions]
python =
    3.9: py39
    3.10: py310
    3.11: py311
    3.12: py312
